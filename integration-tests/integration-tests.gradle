
//Base Java Image

task buildJavaImage (type : Exec) {
    commandLine "docker", "build", "-t", "airhacks/java", "docker-base/java"
}

// Base Paraya Images

task buildPayaraImage(type: Exec) {
    dependsOn buildJavaImage
    commandLine "docker", "build", "-t", "airhacks/payara", "docker-base/payara"
}

task buildPayaraConfiguredImage(type: Exec) {
    dependsOn buildPayaraImage
    commandLine "docker", "build", "-t", "airhacks/payara-configured", "docker-base/payara-configured"
}

task buildPayaraIntegrationImage(type: Exec) {
    dependsOn buildPayaraConfiguredImage
    commandLine "cp", "../../../platform-examples/todo-example/todo-server-javaee/build/libs/todo-app.war", "."
    commandLine "docker", "build", "-t", "dolphin-platform/paraya-integration", "docker-base/payara-integration"
}


task runPayaraIntegrationImage(type: Exec) {
    dependsOn buildPayaraIntegrationImage
    commandLine "docker", "run", "-t", "-p", "8282:8080", "--name", "paraya-integration", "dolphin-platform/paraya-integration"
}

// Base TomEE Image

task buildTomEEImage(type: Exec) {
    dependsOn buildJavaImage
    commandLine "docker", "build", "-t", "airhacks/tomee", "docker-base/tomee"
}

// Base Wildfly Image

task buildWildflyImage(type: Exec) {
    dependsOn buildJavaImage
    commandLine "docker", "build", "-t", "airhacks/wildfly", "docker-base/wildfly"
}

task buildWildflyIntegrationImage(type: Exec) {
    dependsOn buildWildflyImage
    commandLine "docker", "build", "-t", "dolphin-platform/wildfly-integration", "docker-base/wildfly-integration"
}

task runWildflyIntegrationImage(type: Exec) {
    dependsOn buildWildflyIntegrationImage
    commandLine "docker", "run", "-t", "-p", "8282:8080", "--name", "wildfly-integration", "dolphin-platform/wildfly-integration"
}